This code is intended for acadamic porpouses only.
It is not optimized and for sure there are a lot of improvements to be done to it.